# ===============================
# CI/CD PIPELINE - DevSecOps-Pro-Template
# ===============================
# Author: Andres Maqueo
# Description: CI pipeline validated for GitHub integration and build verification
# ===============================

trigger:
  - main  # Ejecutar cuando haya commits en la rama principal

pool:
  vmImage: 'ubuntu-latest'

steps:
  # Paso 1: Clonar tu repo desde GitHub con credenciales seguras
  - checkout: self
    clean: true

  # Paso 2: Validaci√≥n del entorno y conexi√≥n
  - script: |
      echo "=============================="
      echo "üîß Validating environment..."
      echo "Repo: $(Build.Repository.Name)"
      echo "Branch: $(Build.SourceBranch)"
      echo "Commit: $(Build.SourceVersion)"
      echo "Agent OS: $(Agent.OS)"
      echo "=============================="
    displayName: "üîç Environment Check"

  # Paso 3: Prueba simple de CI
  - script: |
      echo "‚úÖ CI pipeline operational!"
      echo "Running security baseline..."
      echo "Code and build ready for next stages."
    displayName: "‚úÖ Basic CI Test"

  # Paso 4: Mantener logs limpios
  - task: PublishBuildArtifacts@1
    inputs:
      PathtoPublish: '$(Build.ArtifactStagingDirectory)'
      ArtifactName: 'build-logs'
    displayName: "üì¶ Publish Build Logs"
